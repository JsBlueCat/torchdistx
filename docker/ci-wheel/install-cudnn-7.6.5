#!/usr/bin/env bash

# Copyright (c) Meta Platforms, Inc. and affiliates.
# All rights reserved.
#
# This source code is licensed under the BSD-style license found in the
# LICENSE file in the root directory of this source tree.

set -o errexit

# cuDNN license: https://developer.nvidia.com/cudnn/license_agreement

mkdir cudnn && cd cudnn

# Taken from https://github.com/pytorch/builder/blob/main/common/install_cuda.sh.
curl --location --fail --output cudnn.tgz\
    https://developer.download.nvidia.com/compute/redist/cudnn/v7.6.5/cudnn-10.2-linux-x64-v7.6.5.32.tgz

tar zxf cudnn.tgz

cp cuda/include/* /usr/local/cuda/include
cp cuda/lib64/* /usr/local/cuda/lib64

cd ..

rm -rf cudnn
